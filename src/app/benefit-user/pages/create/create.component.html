<div class="row mt-5">
  <h1>{{ currentUserBenefits?.id ? 'Actualizar' : 'Nuevo' }} beneficio para {{ currentUserBenefits?.name }}</h1>
  <hr>

  <div class="col">

    <form [formGroup]="createForm" (ngSubmit)="save()">

      <div class="row mb-3">
        <div class="col-xl-9 px-2 d-flex flex-column justify-content-evenly">

          <div class="row">
            <label for="user_id">Selecciona un colaborador</label>
            <div class="input-group">
              <select class="form-select" formControlName="user_id" id="user_id"
                [ngClass]="{'invalid': campoEsValido('user_id')}">
                <option value="">-- Seleccione Colaborador --</option>
                <option *ngFor="let user of users" value="{{ user.id }}">{{ user.name }}</option>
              </select>
              <span *ngIf="userAndBenefitSpinner" class="input-group-text" id="basic-addon1">
                <i class="fa-solid fa-spinner fa-spin fa-xs"></i>
              </span>
            </div>
            <small *ngIf="campoEsValido('user_id')" class="text-danger">{{ userIdErrors }}</small>
          </div>

          <div class="row">
            <label for="benefit_id">Selecciona un beneficio</label>
            <div class="input-group">
              <select class="form-select" formControlName="benefit_id" id="benefit_id"
                [ngClass]="{'invalid': campoEsValido('benefit_id')}" (change)="fillBenefitDetail($event)">
                <option value="">-- Seleccione Beneficio --</option>
                <option *ngFor="let benefit of benefits" value="{{ benefit.id }}">{{ benefit.name }}</option>
              </select>
              <span *ngIf="userAndBenefitSpinner" class="input-group-text" id="basic-addon1">
                <i class="fa-solid fa-spinner fa-spin fa-xs"></i>
              </span>
            </div>
            <small *ngIf="campoEsValido('benefit_id')" class="text-danger">{{ benefitIdErrors }}</small>
          </div>

          <div class="row">
            <label for="benefit_detail_id">Selecciona un Detalle</label>
            <div class="input-group">
              <select class="form-select" formControlName="benefit_detail_id" id="benefit_detail_id"
                [ngClass]="{'invalid': campoEsValido('benefit_detail_id')}">
                <option value="">-- Seleccione Detalle --</option>
                <option *ngFor="let benefit_detail of benefit_details" value="{{ benefit_detail.id }}">
                  {{ benefit_detail.name }}</option>
              </select>
              <span *ngIf="!benefitDetailSpinner" class="input-group-text" id="basic-addon1">
                <i class="fa-solid fa-spinner fa-spin fa-xs"></i>
              </span>
            </div>
            <small *ngIf="campoEsValido('benefit_detail_id')" class="text-danger">{{ benefitDetailIdErrors }}</small>
          </div>

        </div>

        <div class="col-xl-3 px-2 d-flex flex-column">

          <div class="row">
            <ngb-datepicker #dp class=" m-2" formControlName="model" (navigate)="date = $event.next"
              [ngClass]="{'invalid': campoEsValido('model')}" [markDisabled]="isDayDisabled"></ngb-datepicker>
            <small *ngIf="campoEsValido('model')" class="text-danger">{{ datePickerErrors }}</small>
          </div>
          <div class="row">
            <ngb-timepicker #tp class="m-2 d-flex justify-content-around" formControlName="time"
              [ngClass]="{'invalid': campoEsValido('time')}" [meridian]="meridian"></ngb-timepicker>
            <small *ngIf="campoEsValido('time')" class="text-danger">{{ timePickerErrors }}</small>
          </div>

        </div>
      </div>

      <input type="hidden" formControlName="benefit_begin_time" value="{{ benefit_begin_time }}">
      <input type="hidden" formControlName="benefit_end_time">

      <div class="mb-3">
        <button class="btn btn-success float-end" type="submit" [disabled]="disableSubmitBtn">
          {{ ( currentUserBenefits?.id ) ? 'Actualizar' : 'Crear' }}
        </button>
      </div>

    </form>
  </div>
</div>